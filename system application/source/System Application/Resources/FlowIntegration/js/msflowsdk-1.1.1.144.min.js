!function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="../out",e(0)}([function(t,e,i){"use strict";var n=i(10),o=i(40),r=i(41),s=i(48),a=i(47),d=i(43),l=i(49),p=i(1),c=i(46),u=i(45),g=i(44),h=i(42),f=function(){function t(t){if(this.sdkOption=t,!this.sdkOption)throw new n.MsFlowError("Sdk options are required");if(this.sdkOption.hostName&&"string"!=typeof this.sdkOption.hostName)throw new n.MsFlowError("The host name can only be of type string");this.sdkOption.hostName=this.sdkOption.hostName||"https://flow.microsoft.com",this.sdkOption.locale=this.sdkOption.locale||"en-us"}return t.prototype.renderWidget=function(t,e){var i;switch(t){case o.ApprovalCenterWidget.widgetType:i=new o.ApprovalCenterWidget(e,this.sdkOption);break;case r.BpfActionCenterWidget.widgetType:i=new r.BpfActionCenterWidget(e,this.sdkOption);break;case h.ConnectionWizardWidget.widgetType:i=new h.ConnectionWizardWidget(e,this.sdkOption);break;case a.FlowsRuntimeWidget.widgetType:i=new a.FlowsRuntimeWidget(e,this.sdkOption);break;case s.FlowsWidget.widgetType:i=new s.FlowsWidget(e,this.sdkOption);break;case d.FlowCreationWidget.widgetType:i=new d.FlowCreationWidget(e,this.sdkOption);break;case g.FlowDetailsWidget.widgetType:i=new g.FlowDetailsWidget(e,this.sdkOption);break;case u.FlowEditWidget.widgetType:i=new u.FlowEditWidget(e,this.sdkOption);break;case c.FlowNewWidget.widgetType:i=new c.FlowNewWidget(e,this.sdkOption);break;case l.TemplatesWidget.widgetType:i=new l.TemplatesWidget(e,this.sdkOption)}if(!i)throw new n.MsFlowError("please provide a valid supported widget type.");return i},t}();e.MsFlowSdk=f,window.MsFlowSdk=f,window.WidgetTypes=p.WidgetTypes,window.OAuthHandlers=p.OAuthHandlers,window.WellKnownHostIds=p.WellKnownHostIds,window.msFlowSdkLoaded&&window.msFlowSdkLoaded()},function(t,e,i){"use strict";function n(t){if(d.isNullOrUndefined(t)||d.isNullOrUndefined(t.pathname)||d.isNullOrUndefined(t.hostname))return e.WellKnownHostIds.UNSPECIFIED;var i=t.pathname.toLowerCase(),n=t.hostname.toLowerCase(),o=/crm[\d]+\.dynamics.com/;return d.endsWithIgnoreCase(n,".powerapps.com")&&d.startsWithIgnoreCase(n,"make.")?e.WellKnownHostIds.POWERAPPSMAKER:d.endsWithIgnoreCase(n,".powerapps.com")?e.WellKnownHostIds.POWERAPPS:d.endsWithIgnoreCase(n,".sharepoint.com")||d.endsWithIgnoreCase(n,".sharepoint-df.com")||d.endsWithIgnoreCase(n,"msft.spoppe.com")?e.WellKnownHostIds.SHAREPOINT:d.endsWithIgnoreCase(n,".financials.dynamics.com")?e.WellKnownHostIds.DYNAMICS_NAV:d.endsWithIgnoreCase(n,".crm.dynamics.com")||d.endsWithIgnoreCase(n,"crmdynint.com")||o.exec(n)?e.WellKnownHostIds.DYNAMICS_CRM:d.endsWithIgnoreCase(n,"outlook.office.com")||d.endsWithIgnoreCase(n,"outlook-sdf.office.com")?e.WellKnownHostIds.OUTLOOKWEB:d.endsWithIgnoreCase(n,".flow.microsoft.com")||d.endsWithIgnoreCase(n,"dev.azure-flows.net")||d.endsWithIgnoreCase(n,g.SdkSettings.makerPortalDomain)?e.WellKnownHostIds.WIDGETTEST:d.endsWithIgnoreCase(n,".hosting.portal.azure.net")?e.WellKnownHostIds.LOGICAPPS:d.endsWithIgnoreCase(n,".azureiotcentral-dev.com")||d.endsWithIgnoreCase(n,"azureiotcentral.com")?e.WellKnownHostIds.IOT:d.endsWithIgnoreCase(n,"staffhub.office.com")||d.endsWithIgnoreCase(n,"staffhub.ms")?e.WellKnownHostIds.STAFFHUB:d.endsWithIgnoreCase(n,"bankadmin.azurewebsites.net")||d.endsWithIgnoreCase(n,"maui-uat.azurewebsites.net")||d.endsWithIgnoreCase(n,"maui-int.azurewebsites.net")?e.WellKnownHostIds.TREASURY:i.indexOf("widgethosts/teams")>=0?e.WellKnownHostIds.TEAMS:i.indexOf("widgethosts/excel")>=0?e.WellKnownHostIds.EXCEL:d.endsWithIgnoreCase(n,".customercareintelligence.net")||d.endsWithIgnoreCase(n,"powerva.microsoft.com")?e.WellKnownHostIds.POWERVIRTUALAGENTS:e.WellKnownHostIds.UNSPECIFIED}var o=this&&this.__assign||Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},r=i(39),s=i(10),a=i(14),d=i(3),l=i(50),p=i(35),c=i(36),u=i(38),g=i(6);e.WidgetTypes={approvalCenter:"approvalCenter",bpfActionCenter:"bpfActionCenter",connectionWizard:"connectionWizard",flowCreation:"flowCreation",flowDetails:"flowDetails",flowEdit:"flowEdit",flowNew:"flowNew",flowsRuntime:"flowsRuntime",flows:"flows",templates:"templates"},e.ViewContainerTypes={fullPage:"fullPage",modal:"modal",panel:"panel"},e.WellKnownHostIds={DYNAMICS_CRM:"DynCRM",DYNAMICS_NAV:"DynNAV",EXCEL:"Excel",IOT:"IOT",LOGICAPPS:"LogicApps",OUTLOOKWEB:"OWA",POWERAPPS:"PowerApps",POWERAPPSMAKER:"PowerAppsMaker",POWERFLOWADDIN:"PowerFlowAddin",POWERVIRTUALAGENTS:"PowerVirtualAgents",SHAREPOINT:"SPO",STAFFHUB:"StaffHub",TEAMS:"Teams",TEAMSSOLUTIONEXPLORER:"TeamsSolutionExplorer",TREASURY:"Treasury",WIDGETTEST:"WidgetTest",UNSPECIFIED:"Unknown"},e.ErrorCodes={UnlistenedEventCalled:"UnlistenedEventCalled",InvalidRpcEvent:"InvalidRpcEvent"},e.WidgetNotifyActions={CloseInfoPane:"closeInfoPane",CloseWidget:"closeWidget",ConnectionsConfirmed:"connectionsConfirmed",CreateFlowFromTemplate:"createFlowFromTemplate",CreateFlowFromTemplateDefinition:"createFlowFromTemplateDefinition",TriggerFlow:"triggerflow",TriggerFlowByTemplate:"triggerflowbytemplate",GetTriggerSchema:"gettriggerschema",RefreshConnections:"refreshconnections",RefreshApis:"refreshapis",UserSelectionUpdated:"userselectionupdated",ShowAlertBanner:"showalertbanner"},e.WidgetHostAction={EXECUTE_TEAMS_DEEP_LINK:"EXECUTE_TEAMS_DEEP_LINK",FLOW_CREATION_FAILED:"FLOW_CREATION_FAILED",FLOW_CREATION_SUCCEEDED:"FLOW_CREATION_SUCCEEDED",FLOW_INSTALL_FAILED:"FLOW_INSTALL_FAILED",FLOW_INSTALL_SUCCEEDED:"FLOW_INSTALL_SUCCEEDED",GET_ACCESS_TOKEN:"GET_ACCESS_TOKEN",GET_IMPLICIT_DATA:"GET_IMPLICIT_DATA",GET_STRINGS:"GET_STRINGS",SIDE_PANE_VISIBILITY_SET:"SIDE_PANE_VISIBILITY_SET",LAUNCH_OAUTH_POPUP:"LAUNCH_OAUTH_POPUP",ON_ADD_CONNECTION_CLICKED:"ON_ADD_CONNECTION_CLICKED",ON_DELETE_CUSTOM_API_CLICKED:"ON_DELETE_CUSTOMAPI_CLICKED",RUN_FLOW_CANCEL_BUTTON_CLICKED:"RUN_FLOW_CANCEL_BUTTON_CLICKED",RUN_FLOW_DONE_BUTTON_CLICKED:"RUN_FLOW_DONE_BUTTON_CLICKED",RUN_FLOW_STARTED:"RUN_FLOW_STARTED",RUN_FLOW_COMPLETED:"RUN_FLOW_COMPLETED",TEMPLATE_LOAD_FAILED:"TEMPLATE_LOAD_FAILED",WIDGET_CLOSE:"WIDGET_CLOSE",WIDGET_READY:"WIDGET_READY",WIDGET_RENDERED:"WIDGET_RENDERED",RECEIVED_APPROVAL_STATUS_CHANGED:"RECEIVED_APPROVAL_STATUS_CHANGED",SENT_APPROVAL_STATUS_CHANGED:"SENT_APPROVAL_STATUS_CHANGED"};var h={connectionWizard:"/manage{environment}/connections/wizard",myFlows:"/manage{environment}/flows",sharedFlows:"/manage{environment}/flows/shared",receivedApprovals:"/manage{environment}/approvals/received",sentApprovals:"/manage{environment}/approvals/sent",activeBpfs:"/manage{environment}/businessProcess/instances/active",inactiveBpfs:"/manage{environment}/businessProcess/instances/inactive",flowCreation:"/manage{environment}/templates/flowCreation",flowDetails:"/manage{environment}{solution}/flows/{flowName}/details",flowEdit:"/manage{environment}{solution}/flows/{flowName}",flowNewBlank:"/manage{environment}{solution}/flows/new",flowNewAutomated:"/manage{environment}{solution}/flows/new/automated",flowNewInstant:"/manage{environment}{solution}/flows/new/instant",flowNewScheduled:"/manage{environment}{solution}/flows/new/scheduled",flowsRuntime:"/manage{environment}/flow/run",templates:"/templates/"},f=o({},h,{receivedApprovals:"/manage{environment}/approvalcenter/received",sentApprovals:"/manage{environment}/approvalcenter/sent"});e.PathAliasesByWidgetType={connectionWizard:["connectionWizard"],flows:["myFlows","sharedFlows"],approvalCenter:["receivedApprovals","sentApprovals"],bpfActionCenter:["activeBpfs","inactiveBpfs"],flowCreation:["flowCreation"],flowDetails:["flowDetails"],flowEdit:["flowEdit"],flowNew:["flowNewBlank","flowNewAutomated","flowNewInstant","flowNewScheduled"],flowsRuntime:["flowsRuntime"],templates:["templates"]},e.OAuthHandlers={oAuth:"oAuth",teamsOAuth:"teamsOAuth",widgetOAuth:"widgetOAuth"};var w="SIDE_PANE_VISIBILITY_SET",m="GET_ACCESS_TOKEN",O=function(){function t(i,o){if(this.widgetOption=i,this.sdkOption=o,this.callbacks={},this.notifyCallback="NOTIFY",this.widgetReady=!1,!this.widgetOption)throw new s.MsFlowError("Widget requires a widget option.");if(!this.sdkOption)throw new s.MsFlowError("Widget requires a sdk option.");if(this.widgetOption.oAuthHandler&&!d.equalsIgnoreCase(this.widgetOption.oAuthHandler,e.OAuthHandlers.oAuth)&&!d.equalsIgnoreCase(this.widgetOption.oAuthHandler,e.OAuthHandlers.teamsOAuth)&&!d.equalsIgnoreCase(this.widgetOption.oAuthHandler,e.OAuthHandlers.widgetOAuth))throw new s.MsFlowError("Invalid OAuth handler specified: "+this.widgetOption.oAuthHandler);if(!this.sdkOption.hostName||this.sdkOption.hostName.length<1)throw new s.MsFlowError("hostName is required in sdk option.");if("string"==typeof this.sdkOption.hostName&&"/"===this.sdkOption.hostName.charAt(this.sdkOption.hostName.length-1)&&(this.sdkOption.hostName=this.sdkOption.hostName.substring(0,this.sdkOption.hostName.length-1)),d.isNullOrUndefined(this.sdkOption.hostId)&&(this.sdkOption.hostId=n(document.location)),d.isString(this.widgetOption.container)&&(this.widgetOption.container=document.getElementById(this.widgetOption.container)),this.widgetOption.flowName&&"v1/"==this.widgetOption.flowName.substring(0,3)){var r=this.widgetOption.flowName.split("/");this.widgetOption.environmentId=r[1],this.widgetOption.flowName=r[2]}if(!this.widgetOption.container)throw new s.MsFlowError("Widget requires a container element.");if(d.isNullOrUndefined(this.widgetOption.widgetId)&&(this.widgetOption.widgetId=a.uuid()),i.debugMode&&t.allowedDomains.push(g.SdkSettings.portalTestDomain,g.SdkSettings.makerDevPortalDomain),this.widgetOption.enableRegionalPortal){if(this.widgetOption.environmentLocation){var l=u.getRegionalPortalUrl(this.widgetOption.environmentLocation,this.sdkOption.hostName);this.initializeIframe(this.widgetOption.environmentId,l)}}else this.initializeIframe(this.widgetOption.environmentId,this.sdkOption.hostName)}return t.prototype.notify=function(t,e){var i=this;return this.widgetReady?new Promise(function(n,o){var r=i.createRequestParam(),s={actionName:t,actionData:e};r.data=s,i.rpcClient.call(i.notifyCallback,[r]).then(function(t){n(t&&t.data?t.data:null)})["catch"](function(t){t&&t.innerException&&(t=t.innerException.data?t.innerException.data:{code:"UnknownError",message:t.innerException.message}),o(t)})}):Promise.reject({code:"WidgetNotReady",message:"Notify() called before widget has fired WIDGET_READY"})},t.prototype.listen=function(t,e){this.callbacks[t]||(this.callbacks[t]=e,d.equalsIgnoreCase(t,m)&&this.widgetOption.enableRegionalPortal&&!this.widgetOption.environmentLocation&&this.onGetAccessTokenCallbackAdded())},t.prototype.dispose=function(){this.iframe&&(this.widgetOption.container.removeChild(this.iframe),r.removeEventListener("message",this.onReceivedMessageHandler))},t.prototype.onGetAccessTokenCallbackAdded=function(){var t=this,e=this.callbacks[m],i=g.SdkSettings.authResource;if(d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.govHostName,0)||d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.makerGovPortalDomain,0)?i=g.SdkSettings.govAuthResource:d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.highHostName,0)||d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.makerHighPortalDomain,0)?i=g.SdkSettings.highAuthResource:d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.dodPortalDomain,0)||d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.makerDodPortalDomain,0)?i=g.SdkSettings.dodAuthResource:d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.chinaPortalDomain,0)||d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.makerChinaPortalDomain,0)?i=g.SdkSettings.chinaAuthResource:d.stringIncludes(this.sdkOption.hostName,g.SdkSettings.usnatPortalDomain,0)&&(i=g.SdkSettings.usnatAuthResource),e){var n={data:{resource:i},callInfo:{widgetId:this.widgetOption.widgetId}},o=function(e,i){var n=i.token;t.lookupRegionalPortalUrlAndInitializeIframe(n)};try{e(n,o)}catch(r){throw r instanceof s.MsFlowError?r:new Error("failed to get access token")}}},t.prototype.lookupRegionalPortalUrlAndInitializeIframe=function(t){var e=this;if(!t)throw new s.MsFlowError("Flow widget received a null token from the host");c.getEnvironmentInfo(this.sdkOption.hostName,this.widgetOption.environmentId,t).then(function(t){var i=u.getRegionalPortalUrl(t.location,e.sdkOption.hostName);e.initializeIframe(t.name,i)})["catch"](function(t){e.regionalPortalInitFailed=!0,e.initializeIframe(e.widgetOption.environmentId,e.sdkOption.hostName)})},t.prototype.initializeIframe=function(t,e){this.sdkOption.hostName=e,this.widgetOption.environmentId=this.widgetOption.environmentId||t,this.url=this.constructUrl(),this.renderIframe(),this.rpcClient=new l.Rpc({signature:this.widgetOption.widgetId,targetOrigin:"*",rpcMessageHandler:new l.WindowPostMessageRpcHandler({targetWindow:this.iframe.contentWindow})})},t.prototype.createRequestParam=function(){var t={widgetId:this.widgetOption.widgetId};return{callInfo:t}},t.prototype.renderIframe=function(){var t=this;this.iframe=document.createElement("iframe"),this.iframe.setAttribute("src",this.url),this.iframe.setAttribute("id",this.widgetOption.widgetId),this.iframe.setAttribute("name","widgetIFrame"),this.iframe.setAttribute("tabIndex","0"),this.iframe.setAttribute("allow","geolocation"),this.iframe.setAttribute("title",this.widgetOption.iframeTitle||"Microsoft Flow");var i=this.widgetOption.container;this.iframe.scrolling=i.getAttribute("data-mswidget-scrolling")||"yes",i.appendChild(this.iframe),this.onReceivedMessageHandler=function(e){return t.onMessageReceived(e)},r.addEventListener("message",this.onReceivedMessageHandler,!0),this.listen(w,function(e){t.iframe.scrolling=e.data&&e.data.visible?"no":"auto"}),this.listen("CONNECTION_REFERENCES_CONFIRMED",function(i){(t.getWidgetType()===e.WidgetTypes.connectionWizard||t.widgetOption.connectionWizardSettings&&t.widgetOption.connectionWizardSettings.onConnectionReferencesConfirmed)&&t.widgetOption.connectionWizardSettings.onConnectionReferencesConfirmed(i.data)}),this.listen("CONNECTION_WIZARD_CONFIRMATIONBUTTONDETAILS",function(i){(t.getWidgetType()===e.WidgetTypes.connectionWizard||t.widgetOption.connectionWizardSettings&&t.widgetOption.connectionWizardSettings.onConnectionWizardConfirmationButtonDetailsChanged)&&t.widgetOption.connectionWizardSettings.onConnectionWizardConfirmationButtonDetailsChanged(i.data)}),this.listen("CONNECTION_WIZARD_ERROR",function(e){t.widgetOption.connectionWizardSettings&&t.widgetOption.connectionWizardSettings.onConnectionWizardError&&t.widgetOption.connectionWizardSettings.onConnectionWizardError(e.data)}),this.listen("GET_WIDGET_OPTIONS",function(e,i){var n=t.widgetOption,o=n.connectionWizardSettings,r=n.flowDetailsSettings,s=n.flowsSettings,a=n.runtimeSettings,d=n.templatesSettings;i(null,{connectionReferences:o&&o.connectionReferences,flowsFilter:s&&s.flowsFilter,waitAfterInstallingFlow:a&&a.waitAfterInstallingFlow,additionalOwners:t.widgetOption.additionalOwners,embeddedIn:t.widgetOption.embeddedIn,exitWidgetToEditInAdvancedMode:d&&d.exitWidgetToEditInAdvancedMode,hideFlowCreationCloseButton:d&&d.hideFlowCreationCloseButton,hideFlowCreationHeader:d&&d.hideFlowCreationHeader,hideTemplateTitleDietDesigner:d&&d.hideTemplateTitleDietDesigner,hideTemplateTypeDietDesigner:d&&d.hideTemplateTypeDietDesigner,useFlowCreatorSurfaceFromTemplateGallery:d&&d.useFlowCreatorSurfaceFromTemplateGallery,flowDetailsBreadcrumbItems:r&&r.breadcrumbItems,enableDynamicSchemaCallback:t.widgetOption.enableDynamicSchemaCallback,flowDetailsEnableDefaultBreadcrumbs:r&&r.enableDefaultBreadcrumbs,teamsDeepLinkScenariosEnabled:t.widgetOption.teamsDeepLinkScenariosEnabled,exitWidgetToViewCreatedFlow:d&&d.exitWidgetToViewCreatedFlow,pathAliasOverrides:t.widgetOption.pathAliasOverrides,preventCloseOnFlowCreationDoneClicked:d&&d.preventCloseOnFlowCreationDoneClicked,hideDesignerBackButton:s&&s.hideDesignerBackButton,hideDesignerTestButton:s&&s.hideDesignerTestButton})})},t.prototype.onMessageReceived=function(t){if(!this.isValidRpcEvent(t)){var i={name:e.ErrorCodes.InvalidRpcEvent,message:"Widget dropping received message because its RPC event is invalid, event originated from "+t.origin};return this.widgetOption.errorHandler&&this.widgetOption.errorHandler(i),void(this.widgetOption.debugMode&&console.warn(i))}if(t.data.method)switch(t.data.method){case"__PING__":this.rpcAckHandler(t);break;default:this.invokeCallbackHandler(t.data.method,t)}},t.prototype.isValidRpcEvent=function(e){var i=d.endsWithIgnoreCase(e.origin,"/")?e.origin.replace("/",""):e.origin;return d.equalsIgnoreCase(e.data.signature,this.widgetOption.widgetId)&&t.allowedDomains.some(function(t){return d.endsWithIgnoreCase(i,t)})},t.prototype.rpcAckHandler=function(t){var e={id:t.data.id,signature:t.data.signature,result:"__PONG__",error:null};t.source&&t.source.postMessage(e,t.origin)},t.prototype.invokeCallbackHandler=function(t,i){var n;i&&i.data&&i.data.params&&i.data.params.length>0&&(n=i.data.params[0]),t===e.WidgetHostAction.WIDGET_READY&&this.setIsReady();var o=this.callbacks[t],r={id:i.data.id,signature:i.data.signature};if(o){var s=function(t,e){r.result=e,r.error=t,i.source&&i.source.postMessage(r,i.origin)};try{o(n,s)}catch(a){r.error=a,i.source&&i.source.postMessage(r,i.origin)}}else r.error={value:{name:e.ErrorCodes.UnlistenedEventCalled,message:"Event '"+t+"' is not being listened for by the host"}},i.source&&i.source.postMessage(r,i.origin)},t.prototype.constructUrl=function(){return(""+this.constructBaseUrl()+this.getWidgetPath()+this.constructWidgetQueryString()).replace("{environment}",this.widgetOption.environmentId?"/environments/"+this.widgetOption.environmentId:"").replace("{solution}",this.widgetOption.solutionId?"/solutions/"+this.widgetOption.solutionId:"").replace("{flowName}",this.widgetOption.flowName?this.widgetOption.flowName:"")},t.prototype.setIsReady=function(){this.widgetReady=!0},t.prototype.getRpcClient=function(){return this.rpcClient},t.prototype.constructBaseUrl=function(){return"string"==typeof this.sdkOption.hostName?this.sdkOption.hostName+"/"+this.sdkOption.locale+"/widgets":this.sdkOption.hostName[0]+"/"+this.sdkOption.locale+"/widgets"},t.prototype.constructBaseQueryString=function(){var t="?widgetId="+this.widgetOption.widgetId+("&sdkVersion="+p.config.version)+("&widgetType="+this.getWidgetType())+"&utm_medium=widget&utm_source="+this.sdkOption.hostId;return this.widgetOption.sessionId&&(t+="&sessionId="+this.widgetOption.sessionId),this.widgetOption.campaign&&(t+="&utm_campaign="+this.widgetOption.campaign),this.widgetOption.visibleHideKeys&&(t+="&visibleHideKeys="+this.widgetOption.visibleHideKeys),this.widgetOption.environmentId&&(t+="&environment="+this.widgetOption.environmentId),this.widgetOption.solutionId&&(t+="&solutionId="+this.widgetOption.solutionId),d.isNullOrUndefined(this.widgetOption.enableOnBehalfOfTokens)||(t+="&enableOnBehalfOfTokens="+this.widgetOption.enableOnBehalfOfTokens),d.isNullOrUndefined(this.widgetOption.groupId)||(t+="&groupId="+this.widgetOption.groupId),d.isNullOrUndefined(this.widgetOption.enableRegionalPortal)||(t+="&enableRegionalPortal="+this.widgetOption.enableRegionalPortal),d.isNullOrUndefined(this.widgetOption.enableWidgetV2)||(t+="&enableWidgetV2="+this.widgetOption.enableWidgetV2),d.isNullOrUndefined(this.widgetOption.oAuthHandler)&&(this.widgetOption.oAuthHandler=e.OAuthHandlers.oAuth),t+="&oAuthHandler="+this.widgetOption.oAuthHandler},t.prototype.constructHideTabsQueryParam=function(t){return t===!0?"&hideTabs="+t:"&hideTabs=false"},t.prototype.constructWidgetQueryString=function(){var t=this,i=this.constructBaseQueryString();if(this.widgetOption.widgetStyleSettings&&(i+=this.getDynamicParamsUrl(this.widgetOption.widgetStyleSettings)),this.getWidgetType()===e.WidgetTypes.flowsRuntime&&this.widgetOption.flowName&&(i+="&flowName="+this.widgetOption.flowName),this.widgetOption.flowsSettings&&(this.widgetOption.flowsSettings.createFromBlankTemplateId&&(i+="&defaultTemplate="+this.widgetOption.flowsSettings.createFromBlankTemplateId),i+=this.constructHideTabsQueryParam(this.widgetOption.flowsSettings.hideTabs),this.widgetOption.flowsSettings.isMini&&(i+="&isMini=true"),this.widgetOption.flowsSettings.hideFlowCreation&&(i+="&hideFlowCreation=true"),this.widgetOption.flowsSettings.enableBusinessProcessFlow&&(i+="&enableBusinessProcessFlow=true"),this.widgetOption.flowsSettings.allowImplicitConsent&&(i+="&allowImplicitConsent=true"),this.widgetOption.flowsSettings.enableTeamsHomePage&&(i+="&teamsHome=true"),this.widgetOption.flowsSettings.widgetFlowListDisplaySettings&&(i+=this.getDynamicParamsUrl(this.widgetOption.flowsSettings.widgetFlowListDisplaySettings))),this.widgetOption.flowNewSettings&&(this.widgetOption.flowNewSettings.templateName&&(i+="&template="+this.widgetOption.flowNewSettings.templateName),this.widgetOption.flowNewSettings.galleryName&&(i+="&gallery="+this.widgetOption.flowNewSettings.galleryName),this.widgetOption.flowNewSettings.connectionReferences&&Object.keys(this.widgetOption.flowNewSettings.connectionReferences||{}).map(function(e){var n=t.widgetOption.flowNewSettings.connectionReferences[e];i+="&connection."+e+"="+n.selectedConnectionName})),this.widgetOption.approvalCenterSettings){if(i+=this.constructHideTabsQueryParam(this.widgetOption.approvalCenterSettings.hideTabs),this.widgetOption.approvalCenterSettings.approvalsFilter){var n="&approvalsFilter="+encodeURIComponent(this.widgetOption.approvalCenterSettings.approvalsFilter);i+=n}this.widgetOption.approvalCenterSettings.autoNavigateToDetails&&(i+="&autoNavigateToDetails=true"),this.widgetOption.approvalCenterSettings.hideInfoPaneCloseButton&&(i+="&hideInfoPaneCloseButton=true"),this.widgetOption.approvalCenterSettings.hideFlowCreation&&(i+="&hideFlowCreation=true"),this.widgetOption.approvalCenterSettings.showSimpleEmptyPage&&(i+="&showSimpleEmptyPage=true"),this.widgetOption.approvalCenterSettings.hideLink&&(i+="&hideLink=true"),this.widgetOption.approvalCenterSettings.showApprovalHistory&&(i+="&showApprovalHistory=true")}return this.widgetOption.templatesSettings&&(this.widgetOption.templatesSettings.defaultParams&&(i+=this.getDynamicParamsUrl(this.widgetOption.templatesSettings.defaultParams)),this.widgetOption.templatesSettings.destination&&(i+="&destination="+this.widgetOption.templatesSettings.destination),this.widgetOption.templatesSettings.templateCategory&&(i+="&category="+this.widgetOption.templatesSettings.templateCategory),this.widgetOption.templatesSettings.metadataSortProperty&&(i+="&metadataSortProperty="+this.widgetOption.templatesSettings.metadataSortProperty),this.widgetOption.templatesSettings.pageSize&&(i+="&pageSize="+this.widgetOption.templatesSettings.pageSize),this.widgetOption.templatesSettings.useServerSideProvisioning&&(i+="&useServerSideProvisioning="+this.widgetOption.templatesSettings.useServerSideProvisioning),this.widgetOption.templatesSettings.searchTerm&&(i+="&q="+this.widgetOption.templatesSettings.searchTerm),this.widgetOption.templatesSettings.enableTemplatesPageShell&&(i+="&templatesShell="+this.widgetOption.templatesSettings.enableTemplatesPageShell),this.widgetOption.templatesSettings.hideSidePanel&&(i+="&hideSidePanel="+this.widgetOption.templatesSettings.hideSidePanel),this.widgetOption.templatesSettings.hideStartWithDescription&&(i+="&hideStartWithDescription="+this.widgetOption.templatesSettings.hideStartWithDescription),this.widgetOption.templatesSettings.showCreateButtonOnLeft&&(i+="&showCreateButtonOnLeft="+this.widgetOption.templatesSettings.showCreateButtonOnLeft),this.widgetOption.templatesSettings.showGoBack&&(i+="&showGoBack=true"),this.widgetOption.templatesSettings.enableWidgetCloseOnFlowSave&&(i+="&enableWidgetCloseOnFlowSave="+this.widgetOption.templatesSettings.enableWidgetCloseOnFlowSave),this.widgetOption.templatesSettings.enableDietDesigner&&(i+="&enableDietDesigner="+this.widgetOption.templatesSettings.enableDietDesigner),this.widgetOption.templatesSettings.allowCustomFlowName&&(i+="&allowCustomFlowName="+this.widgetOption.templatesSettings.allowCustomFlowName),this.widgetOption.templatesSettings.showCreateFromBlank&&(i+="&showCreateFromBlank=true"),this.widgetOption.templatesSettings.showHiddenTemplates&&(i+="&showHiddenTemplates=true"),this.widgetOption.templatesSettings.oneClickCategory&&(i+="&oneClickCategory="+this.widgetOption.templatesSettings.oneClickCategory),this.widgetOption.templatesSettings.dietCategory&&(i+="&dietCategory="+this.widgetOption.templatesSettings.dietCategory),this.widgetOption.templatesSettings.waitAfterSavingFlow&&(i+="&waitAfterSavingFlow="+this.widgetOption.templatesSettings.waitAfterSavingFlow)),this.widgetOption.runtimeSettings&&(i+=this.getDynamicParamsUrl(this.widgetOption.runtimeSettings)),i+="&pathAlias="+this.getWidgetPathAlias(),this.regionalPortalInitFailed&&(i+="&regionalPortalInitFailed=true"),this.widgetOption.historyDisabled&&(i+="&historyDisabled=true"),i+="&allowOptionalEvents=true"},t.prototype.getWidgetPathAlias=function(){var t;switch(this.getWidgetType()){case e.WidgetTypes.flows:t=this.widgetOption.flowsSettings?this.widgetOption.flowsSettings.tab:null;break;case e.WidgetTypes.flowNew:t=this.widgetOption.flowNewSettings?this.widgetOption.flowNewSettings.tab:null;break;case e.WidgetTypes.approvalCenter:t=this.widgetOption.approvalCenterSettings?this.widgetOption.approvalCenterSettings.tab:null;break;case e.WidgetTypes.bpfActionCenter:t=this.widgetOption.bpfActionCenterSettings?this.widgetOption.bpfActionCenterSettings.tab:null}var i=e.PathAliasesByWidgetType[this.getWidgetType()];if(t&&i.indexOf(t)===-1)throw new s.MsFlowError("Please provide a valid widget tab identifier for the specified widget type. "+("Widget type '"+this.getWidgetType()+"' does not support tab '"+t+"'. Supported tabs for ")+("this widget type are: '"+JSON.stringify(i)+"'."));return t?t:i[0]},t.prototype.getWidgetPath=function(){var t=this;return g.MakerShellAllowedDomains.some(function(e){return d.endsWithIgnoreCase(t.sdkOption.hostName,e)})?f[this.getWidgetPathAlias()]:h[this.getWidgetPathAlias()]},t.prototype.getDynamicParamsUrl=function(t){var e="";if(Object.keys(t).length>0)try{var i=Object.keys(t).filter(function(e){return!d.isNullOrUndefined(t[e])});e="&"+i.map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}catch(n){throw new Error("Failed to create url params out of dynamic params data. Exception: "+n)}return e},t}();O.widgetPrefix="msflowsdk",O.allowedDomains=g.DefaultAllowedDomains.concat(g.MakerShellAllowedDomains),e.Widget=O,e.deriveHostId=n},function(t,e,i){"use strict";function n(t,e){var i,n=""+t;return n&&e&&(i=o.equalsIgnoreCase(n.substring(0,e.length),e)),i}var o=i(5);e.startsWithIgnoreCase=n},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}n(i(5)),n(i(23)),n(i(24)),n(i(2)),n(i(8)),n(i(25)),n(i(26))},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}n(i(7)),n(i(19)),n(i(20)),n(i(21)),n(i(22))},function(t,e){"use strict";function i(t,e){return t=(""+t).toUpperCase(),e=(""+e).toUpperCase(),t===e}e.equalsIgnoreCase=i},function(t,e){"use strict";e.SdkSettings={authResource:"https://management.core.windows.net/",govAuthResource:"https://gov.service.flow.microsoft.us/",highAuthResource:"https://high.service.flow.microsoft.us/",dodAuthResource:"https://service.flow.appsplatform.us/",chinaAuthResource:"https://service.powerautomate.cn/",usnatAuthResource:"https://service.flow.eaglex.ic.gov/",apiVersion:"2016-11-01",portalDomain:"flow.microsoft.com",providerName:"microsoft.processsimple",apiUrl:"https://api.flow.microsoft.com",govApiUrl:"https://gov.api.flow.microsoft.us",highApiUrl:"https://high.api.flow.microsoft.us",dodApiUrl:"https://api.flow.appsplatform.us",chinaApiUrl:"https://api.powerautomate.cn",usnatApiUrl:"https://api.flow.eaglex.ic.gov",tip1ApiUrl:"https://tip1.api.flow.microsoft.com",tip1ApiVersion:"2016-11-01-beta",tip1PortalDomain:"tip1.flow.microsoft.com",tip2ApiUrl:"https://tip2.api.flow.microsoft.com",tip2ApiVersion:"2016-11-01-alpha",tip2PortalDomain:"tip2.flow.microsoft.com",portalTestDomain:"flows.azure-test.net",govPortalDomain:"flow.microsoft.us",govHostName:"gov.flow.microsoft.us",highHostName:"high.flow.microsoft.us",dodPortalDomain:"flow.appsplatform.us",chinaPortalDomain:"www.powerautomate.cn",usnatPortalDomain:"www.flow.eaglex.ic.gov",makerChinaPortalDomain:"make.powerautomate.cn",makerDevPortalDomain:"local.flow.microsoft.com:44300",makerPortalDomain:"powerautomate.com",makerGovPortalDomain:"gov.powerautomate.us",makerHighPortalDomain:"high.powerautomate.us",makerDodPortalDomain:"powerautomate.appsplatform.us",makerTestPortalDomain:"test.powerautomate.com",makerPreprodPortalDomain:"preprod.powerautomate.com",makerPreviewPortalDomain:"preview.powerautomate.com"},e.DefaultAllowedDomains=[e.SdkSettings.portalDomain,e.SdkSettings.govPortalDomain,e.SdkSettings.dodPortalDomain,e.SdkSettings.chinaPortalDomain,e.SdkSettings.usnatPortalDomain],e.MakerShellAllowedDomains=[e.SdkSettings.makerPortalDomain,e.SdkSettings.makerGovPortalDomain,e.SdkSettings.makerHighPortalDomain,e.SdkSettings.makerChinaPortalDomain,e.SdkSettings.makerDodPortalDomain,e.SdkSettings.makerPreviewPortalDomain,e.SdkSettings.makerPreprodPortalDomain]},function(t,e){"use strict";function i(t,e,i){for(var n in t)t.hasOwnProperty(n)&&e.call(i,{key:n,value:t[n]})}e.forEach=i},function(t,e,i){"use strict";function n(t,e){var i,n=""+t;return n&&e&&(i=o.equalsIgnoreCase(n.substr(n.length-e.length),e)),i}var o=i(5);e.endsWithIgnoreCase=n},function(t,e,i){"use strict";function n(t){var e={};return t?(r.startsWithIgnoreCase(t,"?")&&(t=t.substring(1)),t.split("&").forEach(function(t){var i=t.split("="),n=i[0],o=i[1];e[decodeURIComponent(n||"")]=decodeURIComponent(o||"")}),e):e}function o(t){return Object.keys(t||{}).map(function(e){var i=encodeURIComponent(e),n=encodeURIComponent(t[e]);return i+"="+n}).join("&")}var r=i(2);e.parseQueryString=n,e.createQueryString=o},function(t,e){"use strict";var i=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=function(t){function e(i){var n=t.call(this,e.errorName+": message")||this;return n.message=i,n.name=e.errorName,n}return i(e,t),e}(Error);n.errorName="MsFlowSdk",e.MsFlowError=n},function(t,e){"use strict";function i(t){return t?new Date(t):null}e.getDate=i},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}n(i(13)),n(i(11))},function(t,e){"use strict";function i(t){var e="";if(t.hasOwnProperty("toISOString"))e=t.toISOString();else{var i=t.getUTCFullYear(),o=n(t.getUTCMonth()+1,2),r=n(t.getUTCDate(),2),s=n(t.getUTCHours(),2),a=n(t.getUTCMinutes(),2),d=n(t.getUTCSeconds(),2),l=n(t.getUTCMilliseconds(),3);e=i+"-"+o+"-"+r+"T"+s+":"+a+":"+d+"."+l+"Z"}return e}function n(t,e){for(var i=""+t,n=i.length,o=n;o<e;o++)i="0"+i;return i}e.toISOString=i},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}var o=i(12);e.date=o;var r=i(15);e.json=r;var s=i(4);e.object=s;var a=i(3);e.string=a;var d=i(29);e.url=d,n(i(18)),n(i(34))},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}n(i(16)),n(i(17))},function(t,e){"use strict";function i(t,e){var i=[],n=function(t,e){if(null!==e&&"object"==typeof e){if(i.indexOf(e)>=0)return;i.push(e)}return e};return t?JSON.stringify(t,n,e?"\t":4):""}e.prettyStringify=i},function(t,e,i){"use strict";function n(t){if(o.isObject(t)){"function"==typeof t.toJSON&&(t=t.toJSON());var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push({key:i,value:t[i]});e.sort(function(t,e){return t.key<e.key?-1:1;
});var r=e.map(function(t){return'"'+t.key+'":'+n(t.value)});return"{"+r.join(",")+"}"}if(Array.isArray(t)){"function"==typeof t.toJSON&&(t=t.toJSON());var s=t.map(function(t){return n(t)});return"["+s.join(",")+"]"}return JSON.stringify(t)}var o=i(4);e.stableStringify=n},function(t,e){"use strict";var i=function(){function t(t){this.initialized=!1,this.func=t}return Object.defineProperty(t.prototype,"value",{get:function(){if(this.initialized){if(this.cachedError)throw this.cachedError;return this.cachedValue}try{return this.cachedValue=this.func(),this.cachedValue}catch(t){throw this.cachedError=t,t}finally{this.initialized=!0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValueCreated",{get:function(){return this.initialized},enumerable:!0,configurable:!0}),t}();e.Lazy=i},function(t,e){"use strict";function i(t,e){return t[e]}e.getEnumValue=i},function(t,e){"use strict";function i(t){return!(!t||"object"!=typeof t||t instanceof Date||t instanceof RegExp||Array.isArray(t))}e.isObject=i},function(t,e){"use strict";function i(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}e.isObjectEmpty=i},function(t,e,i){"use strict";function n(t,e,i){var n=[];return o.forEach(t,function(t){var o=e.call(i,t);null!==o&&void 0!==o&&n.push(o)}),n}var o=i(7);e.map=n},function(t,e){"use strict";function i(){var t,e=Array.prototype.slice.apply(arguments),i=e[0]||"",n=e.slice(1),o=/\{[a-zA-Z$_\d]*\}/g,r=/\{(\d+)\}/g,s=!1;if(n&&1===n.length&&n[0]&&"object"==typeof n[0]){var a=n[0];t=i.replace(o,function(t){var e=t.substring(1,t.length-1);return a.hasOwnProperty(e)?(s=!0,a[e]):t})}return s||(t=i.replace(r,function(t,i){return void 0!==e[i]?e[i]:t})),t}e.format=i},function(t,e){"use strict";function i(t){return null===t||void 0===t}e.isNullOrUndefined=i},function(t,e){"use strict";function i(t){return"string"==typeof t||t instanceof String}e.isString=i},function(t,e){"use strict";function i(t,e,i){return"undefined"==typeof i&&(i=0),String.prototype.indexOf.call(t,e,i)>=0}e.stringIncludes=i},function(t,e,i){"use strict";function n(t,e){return r.endsWithIgnoreCase(t,"/")&&o.startsWithIgnoreCase(e,"/")?t.substring(0,t.length-1)+e:r.endsWithIgnoreCase(t,"/")||o.startsWithIgnoreCase(e,"/")?t+e:t+"/"+e}var o=i(2),r=i(8);e.concatParts=n},function(t,e,i){"use strict";function n(t,e,i,n){var o=new r(t,e);return o.format(i,n)}var o=i(4);e.formatDottedUrl=n;var r=function(){function t(t,e){this._dottedUrlTemplate=[t,e].join("/")}return t.prototype.format=function(t,e){var i=this;t=t||{},e=e||{};var n={},r=this._dottedUrlTemplate.replace(/:(\w+?)(\W|$)/g,function(o,r,s){if(!t[r])return""+s;var a=t[r];return"string"==typeof a&&"@"===a[0]&&(a=i._lookupDottedPath(e||{},a)),angular.isFunction(a)&&(a=a()),n[r]=a,a+s}),s={};o.forEach(t,function(t){n[t.key]||(s[t.key]=angular.isFunction(t.value)?t.value():t.value)}),r=r.split("://").map(function(t){return t.replace(/[\/]{2,}/g,"/")}).join("://"),r=this._encodeUri(r);var a=this._getQueryString(s);return a&&(r=r+(/\?/.test(r)?"&":"?")+a),r},t.prototype._lookupDottedPath=function(t,e){try{return""+(e||"").split(".").reduce(function(t,e){return t[e]},t)}catch(i){return""}},t.prototype._getQueryString=function(t){var e=this,i=o.map(t,function(t){var i=e._camelCaseToHypens(t.key);return e._encodeQueryStringComponent(i)+"="+e._encodeQueryStringComponent(t.value)});return i.join("&")},t.prototype._camelCaseToHypens=function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},t.prototype._encodeUri=function(t){return encodeURI(t).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+").replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},t.prototype._encodeQueryStringComponent=function(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},t}()},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}n(i(27)),n(i(28)),n(i(30)),n(i(31)),n(i(9)),n(i(32)),n(i(33))},function(t,e,i){"use strict";function n(t){return s.startsWithIgnoreCase(t,"http://")}function o(t){return s.startsWithIgnoreCase(t,"https://")}function r(t){return o(t)||n(t)}var s=i(2);e.isHttpUrl=n,e.isHttpsUrl=o,e.isAbsoluteUrl=r},function(t,e,i){"use strict";function n(t){var e=document.createElement("a");e.href=t;var i=e.pathname||"";return r.startsWithIgnoreCase(i,"/")||(i="/"+i),{raw:t,protocol:e.protocol?e.protocol.replace(/:/g,""):"",host:e.host||"",hostname:e.hostname||"",port:e.port?Number(e.port):void 0,path:i,parameters:o.parseQueryString(e.search||""),hash:decodeURIComponent(e.hash||"")}}var o=i(9),r=i(2);e.parseUri=n},function(t,e){"use strict";function i(t){return t.replace(/^\/+/,"")}e.stripLeadingSlashes=i},function(t,e){"use strict";function i(t){return t.replace(/\/+$/,"")}e.stripTrailingSlashes=i},function(t,e){"use strict";function i(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,o=4294967295*Math.random()|0,r=n[255&t]+n[t>>8&255]+n[t>>16&255]+n[t>>24&255],s=n[255&e]+n[e>>8&255]+"-"+n[e>>16&15|64]+n[e>>24&255],a=n[63&i|128]+n[i>>8&255]+"-"+n[i>>16&255]+n[i>>24&255],d=n[255&o]+n[o>>8&255]+n[o>>16&255]+n[o>>24&255];return r+"-"+s+"-"+a+"-"+d}for(var n=[],o=0;o<256;o++)n[o]=(o<16?"0":"")+o.toString(16);e.uuid=i},function(t,e){"use strict";e.config={version:"2.1"}},function(t,e,i){"use strict";function n(t,e){(s.isNullOrUndefined(e)||""===e.trim())&&(e="~default");var i=r.SdkSettings.apiVersion,n=r.SdkSettings.apiUrl;return t=t.toLowerCase(),t&&(s.stringIncludes(t,r.SdkSettings.tip1PortalDomain,0)||s.stringIncludes(t,r.SdkSettings.portalTestDomain,0)||s.stringIncludes(t,r.SdkSettings.makerTestPortalDomain,0)||s.stringIncludes(t,r.SdkSettings.makerPreprodPortalDomain,0))?(i=r.SdkSettings.tip1ApiVersion,n=r.SdkSettings.tip1ApiUrl):t&&s.stringIncludes(t,r.SdkSettings.tip2PortalDomain,0)&&(i=r.SdkSettings.tip2ApiVersion,n=r.SdkSettings.tip2ApiUrl),t&&(s.stringIncludes(t,r.SdkSettings.govHostName,0)||s.stringIncludes(t,r.SdkSettings.makerGovPortalDomain,0))?n=r.SdkSettings.govApiUrl:t&&(s.stringIncludes(t,r.SdkSettings.highHostName,0)||s.stringIncludes(t,r.SdkSettings.makerHighPortalDomain,0))?n=r.SdkSettings.highApiUrl:t&&(s.stringIncludes(t,r.SdkSettings.dodPortalDomain,0)||s.stringIncludes(t,r.SdkSettings.makerDodPortalDomain,0))?n=r.SdkSettings.dodApiUrl:t&&(s.stringIncludes(t,r.SdkSettings.chinaPortalDomain,0)||s.stringIncludes(t,r.SdkSettings.makerChinaPortalDomain,0))?n=r.SdkSettings.chinaApiUrl:t&&s.stringIncludes(t,r.SdkSettings.usnatPortalDomain,0)&&(n=r.SdkSettings.usnatApiUrl),n+"/providers/"+r.SdkSettings.providerName+"/environments/"+e+"?api-version="+i}function o(t,e,i){var o=n(t,e);return a.getJson(o,i).then(function(t){return{name:t.name,location:t.location}})}var r=i(6),s=i(3),a=i(37);e.getEnvironmentUrl=n,e.getEnvironmentInfo=o},function(t,e){"use strict";function i(t,e){return new Promise(function(i,n){var o=new XMLHttpRequest;o.open("GET",t),o.onload=function(){if(o.status>=200&&o.status<300)try{i(JSON.parse(o.responseText))}catch(t){n({status:o.status,statusText:t})}else n({status:o.status,statusText:o.statusText})},o.onerror=function(){n({status:o.status,statusText:o.statusText})},o.open("GET",t),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","Bearer "+e),o.send()})}e.getJson=i},function(t,e,i){"use strict";function n(t){if(!t)return null;var e=t.toLowerCase();switch(e){case"unitedstatesfirstrelease":return"preview";case"unitedstates":return"us";case"unitedkingdom":return"uk";case"europe":return"emea";case"usgov":return"gov";case"usgovhigh":return"high";case"china":return"";case"dod":case"usdod":case"usnat":return"";default:return e}}function o(t,e){if(r.isNullOrUndefined(t)||""===t.trim())return e;var i,o=n(t);return e=e.toLowerCase(),s.MakerShellAllowedDomains.some(function(t){return r.endsWithIgnoreCase(e,t)})?(o="make",r.stringIncludes(e,s.SdkSettings.makerDodPortalDomain,0)?i=s.SdkSettings.makerDodPortalDomain:r.stringIncludes(e,s.SdkSettings.makerHighPortalDomain,0)?i=s.SdkSettings.makerHighPortalDomain:r.stringIncludes(e,s.SdkSettings.makerGovPortalDomain,0)?i=s.SdkSettings.makerGovPortalDomain:r.stringIncludes(e,s.SdkSettings.makerDevPortalDomain,0)?i=s.SdkSettings.makerDevPortalDomain:r.stringIncludes(e,s.SdkSettings.makerTestPortalDomain,0)?i=s.SdkSettings.makerTestPortalDomain:r.stringIncludes(e,s.SdkSettings.makerPreprodPortalDomain,0)?i=s.SdkSettings.makerPreprodPortalDomain:r.stringIncludes(e,s.SdkSettings.makerPreviewPortalDomain,0)?i=s.SdkSettings.makerPreviewPortalDomain:r.stringIncludes(e,s.SdkSettings.makerChinaPortalDomain,0)?(o="",i=s.SdkSettings.makerChinaPortalDomain):i=s.SdkSettings.makerPortalDomain):r.stringIncludes(e,s.SdkSettings.portalTestDomain,0)?(o="dev",i=s.SdkSettings.portalTestDomain):r.stringIncludes(e,s.SdkSettings.tip1PortalDomain,0)?i=s.SdkSettings.tip1PortalDomain:r.stringIncludes(e,s.SdkSettings.tip2PortalDomain,0)?(o="",i=s.SdkSettings.tip2PortalDomain):i=r.stringIncludes(e,s.SdkSettings.govPortalDomain,0)?s.SdkSettings.govPortalDomain:r.stringIncludes(e,s.SdkSettings.dodPortalDomain,0)?s.SdkSettings.dodPortalDomain:r.stringIncludes(e,s.SdkSettings.chinaPortalDomain,0)?s.SdkSettings.chinaPortalDomain:r.stringIncludes(e,s.SdkSettings.usnatPortalDomain,0)?s.SdkSettings.usnatPortalDomain:s.SdkSettings.portalDomain,""===o?"https://"+i:"https://"+o+"."+i}var r=i(3),s=i(6);e.getHostNamePrefixFromGeoLocation=n,e.getRegionalPortalUrl=o},function(t,e){"use strict";function i(t,e,i){window.addEventListener?window.addEventListener(t,e,i):window.attachEvent(t,e)}function n(t,e,i){window.removeEventListener?window.removeEventListener(t,e,i):window.detactEvent(t,e)}e.addEventListener=i,e.removeEventListener=n},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.approvalCenter,e.ApprovalCenterWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.bpfActionCenter,e.BpfActionCenterWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.connectionWizard,e.ConnectionWizardWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.flowCreation,e.FlowCreationWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.flowDetails,e.FlowDetailsWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.flowEdit,e.FlowEditWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.flowNew,e.FlowNewWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.flowsRuntime,e.FlowsRuntimeWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.flows,e.FlowsWidget=r},function(t,e,i){"use strict";var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(1),r=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.widgetOption=e,n.sdkOption=i,n}return n(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e}(o.Widget);r.widgetType=o.WidgetTypes.templates,e.TemplatesWidget=r},function(t,e,i){var n;n=function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var n,o;n=[i,e,i(1),i(2)],o=function(t,e,i,n){"use strict";function o(){var t={};return t.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),t}var r="__PING__",s="__PONG__",a=function(){function t(t){var e=this;if(this._deferredResponses={},this._rpcMethods={},this._ready=!1,this._queuedRequestMessages=[],this._onRpcMessageRecieved=function(t){if(t&&t.signature===e._rpcOptions.signature){var i=t;i.method?e._onRpcRequestMessageReceived(i):e._onRpcResponseMessageReceived(t)}},this._onRpcRequestMessageReceived=function(t){var i=e._rpcMethods[t.method];if(i){var n={signature:t.signature,id:t.id,error:null};try{var o=i.apply(e,t.params);e._rpcOptions.Promise.resolve(o).then(function(t){n.result=t,e._rpcOptions.rpcMessageHandler.postMessage(n,e._rpcOptions.targetOrigin)})["catch"](function(t){n.error=e._serializeError(t),e._rpcOptions.rpcMessageHandler.postMessage(n,e._rpcOptions.targetOrigin)})}catch(r){n.error=e._serializeError(r),e._rpcOptions.rpcMessageHandler.postMessage(n,e._rpcOptions.targetOrigin)}}},this._onRpcResponseMessageReceived=function(t){var i=e._deferredResponses[t.id];i&&(t.error?i.reject(e._deserializeError(t.error)):i.resolve(t.result),delete e._deferredResponses[t.id])},!t)throw new Error("rpcOptions required");t.Promise||(t.Promise={defer:o,resolve:function(t){return Promise.resolve(t)},reject:function(t){return Promise.reject(t)}}),this._rpcOptions=t,this._rpcOptions.rpcMessageHandler.addListener(this._onRpcMessageRecieved),this.register(r,this._onPing)}return t.prototype.ack=function(){var t=this;return this.unregister(r),this.call(r).then(function(e){return e!==s?Promise.reject(new Error("Invalid PONG message"+e)):(t._ready=!0,void t._processQueue())})["catch"](function(e){return t.register(r,t._onPing),console.error("PING failed to receive PONG message",e),Promise.reject(e)})},t.prototype.call=function(t,e){var i=n["default"](),o={signature:this._rpcOptions.signature,id:i,method:this._normalizeMethodName(t),params:e},s=this._rpcOptions.Promise.defer();return this._deferredResponses[i]=s,this._ready||t===r?this._call(o):this._queuedRequestMessages.push(o),s.promise},t.prototype.register=function(t,e){var i=this._normalizeMethodName(t);if(this._rpcMethods[i])throw new Error("Rpc method with name '"+t+"' already registered.");this._rpcMethods[i]=e},t.prototype.unregister=function(t){var e=this._normalizeMethodName(t);if(!this._rpcMethods[e])throw new Error("Rpc method with name "+t+" failed to unregister. Method not found");delete this._rpcMethods[e]},t.prototype.dispose=function(){var t=this;this._rpcMethods={},Object.keys(this._deferredResponses).forEach(function(e){return t._deferredResponses[e].reject(new Error("rpc disposed"))}),this._deferredResponses={},this._rpcOptions.rpcMessageHandler.removeListener(this._onRpcMessageRecieved)},t.prototype._call=function(t){try{this._rpcOptions.rpcMessageHandler.postMessage(t,this._rpcOptions.targetOrigin)}catch(e){this._deferredResponses[t.id].reject(e),delete this._deferredResponses[t.id]}},t.prototype._onPing=function(){return this.unregister(r),this._ready=!0,this._processQueue(),s},t.prototype._processQueue=function(){var t=this;this._queuedRequestMessages.forEach(function(e){return t._call(e)}),this._queuedRequestMessages=[]},t.prototype._normalizeMethodName=function(t){return t.toUpperCase()},t.prototype._serializeError=function(t){if(t instanceof Error){var e={name:t.name,message:t.message,_stack:t.stack};return Object.keys(t).forEach(function(i){e[i]=t[i]}),{value:e}}return{value:t}},t.prototype._deserializeError=function(t){return new i.RpcException("ReceiverFailed","Receiver failed",i.convertToException(t.value))},t}();e.Rpc=a;var d=function(){function t(t){if(this._listeners={},!t)throw new Error("options required");if(!t.targetWindow)throw new Error("targetWindow required");t.sourceWindow=t.sourceWindow||window,t.messageSerializer=t.messageSerializer||function(t){return t},t.messageDeserializer=t.messageDeserializer||function(t){return t},this._options=t}return t.prototype.postMessage=function(t,e){this._options.targetWindow.postMessage(this._options.messageSerializer(t),e)},t.prototype.addListener=function(t){var e=this;this._listeners[t]&&console.error("duplicate rpc listener added"),this._listeners[t]=function(i){var n=e._options.messageDeserializer(i.data);n&&t(n.method?{signature:n.signature,id:n.id,method:n.method,params:n.params}:{signature:n.signature,id:n.id,result:n.result,error:n.error})},this._options.sourceWindow.addEventListener("message",this._listeners[t])},t.prototype.removeListener=function(t){this._options.sourceWindow.removeEventListener("message",this._listeners[t]),delete this._listeners[t]},t}();e.WindowPostMessageRpcHandler=d}.apply(e,n),!(void 0!==o&&(t.exports=o))},function(t,e,i){var n,o,r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};n=[i,e],o=function(t,e){"use strict";function i(t){return t instanceof Error||t.name&&t.message&&!t.hasOwnProperty("_stackTrace")?new n("ErrorException","Error",t.message,t):t.type&&t.code&&t.message&&t.hasOwnProperty("_stackTrace")?t:new o(t)}var n=function(){function t(t,e,i,n,o){void 0===n&&(n=null),void 0===o&&(o=null);var r=n&&n instanceof Error?n:new Error(i);if(!t)throw new a("Type cannot be empty for exception");if(this._type=t,!e)throw new a("Code cannot be empty for exception");if(this._code=e,!i)throw new a("Message cannot be empty for exception");this._message=i,this._data=n,this._stackTrace=r.stack,this._innerException=o}return Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this._code},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stackTrace",{get:function(){return this._stackTrace},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerException",{get:function(){return this._innerException},enumerable:!0,configurable:!0}),t}();e.Exception=n;var o=function(t){function e(e){return t.call(this,"UnknownException","UnknownException","Unknown error.",e)||this}return r(e,t),e}(n);e.UnknownException=o;var s=function(t){function e(e,i,n){return void 0===n&&(n=null),t.call(this,"RpcException",e,i,null,n)||this}return r(e,t),e}(n);e.RpcException=s;var a=function(t){function e(e){return t.call(this,"ArgumentException","ArgumentException",e,null,null)||this}return r(e,t),e}(n);e.ArgumentException=a,e.convertToException=i}.apply(e,n),!(void 0!==o&&(t.exports=o))},function(t,e,i){var n,o;n=[i,e],o=function(t,e){"use strict";function i(){for(var t,e="",i=0;i<4;i++)t=4294967296*Math.random()|0,e+=n[15&t]+n[t>>4&15]+n[t>>8&15]+n[t>>12&15]+n[t>>16&15]+n[t>>20&15]+n[t>>24&15]+n[t>>28&15];var r=n[8+4*Math.random()|0];return e.substr(0,8)+o+e.substr(9,4)+o+"4"+e.substr(13,3)+o+r+e.substr(16,3)+o+e.substr(19,12)}var n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],o="-";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=i}.apply(e,n),!(void 0!==o&&(t.exports=o))}])}.call(e,i,e,t),!(void 0!==n&&(t.exports=n))}]);
//# sourceMappingURL=msflowsdk.js.map